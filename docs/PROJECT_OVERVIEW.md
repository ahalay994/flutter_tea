# Обзор проекта "Tea App"

## Назначение приложения

"Tea App" - это мобильное приложение для каталогизации и управления информацией о различных видах чая. Приложение позволяет пользователям:
- Просматривать каталог чаёв с подробной информацией
- Добавлять новые виды чая с описанием, изображениями и характеристиками
- Фильтровать чаи по различным критериям (страна, тип, вкус, внешний вид)
- Просматривать детальную информацию о каждом чае
- Работать в оффлайн режиме

## Архитектурные особенности

### 1. MVVM архитектура
- **Model (models/):** Представление данных (TeaModel, ImageModel)
- **View (screens/, widgets/):** Отображение пользовательского интерфейса
- **ViewModel (controllers/, services/):** Бизнес-логика и управление состоянием

### 2. Управление состоянием
- **Riverpod:** Современная система управления состоянием
- **StateNotifierProvider:** Для изменяемого состояния (фильтры)
- **FutureProvider:** Для асинхронных данных (списки чаёв)
- **StreamProvider:** Для данных в реальном времени (статус подключения)

### 3. Многоуровневая архитектура
- **Presentation Layer:** Виджеты и экраны
- **Business Logic Layer:** Контроллеры и сервисы
- **Data Layer:** API клиенты и модели

## Основные функции

### 1. Каталог чаёв
- Постраничная загрузка данных
- Бесконечный скролл
- Фильтрация по нескольким критериям
- Поиск по тексту
- Отображение изображений и описаний

### 2. Добавление чая
- Форма с полями для всех атрибутов чая
- Выбор страны, типа, внешнего вида, вкусов
- Загрузка и предварительный просмотр изображений
- Редактор Rich Text для описания и руководства

### 3. Детали чая
- Полная информация о чае
- Галерея изображений
- Рендеринг Rich Text контента
- Возможность редактирования и удаления

### 4. Система фильтрации
- **Мультиселект фильтры:** Классические фильтры с возможностью выбора нескольких значений
- **Фасетные фильтры:** Фильтры с отображением количества результатов для каждого значения
- **Поиск по тексту:** Поиск по названию, описанию, руководству и другим полям
- **Комбинация фильтров:** Возможность комбинировать несколько фильтров одновременно

### 5. Оффлайн режим
- Хранение данных в локальной базе SQLite
- Работа при отсутствии интернета
- Синхронизация данных при восстановлении подключения
- Отображение статуса подключения

## Ключевые технологии

### 1. Flutter
- **Версия:** 3.10.8 и выше
- **Преимущества:** Кроссплатформенность, производительность, богатая экосистема

### 2. Riverpod
- **Версия:** 3.2.1
- **Преимущества:** Мощная система управления состоянием, тестопригодность, производительность

### 3. SQLite
- Локальное хранение данных
- Поддержка сложных запросов с JOIN и GROUP BY
- Пагинация и фильтрация на уровне базы данных

### 4. HTTP клиенты
- Взаимодействие с REST API
- Обработка ошибок и статусов
- Кеширование и повторные попытки

## Структура данных

### 1. TeaModel
```dart
class TeaModel {
  final int id;
  final String name;
  final String? country;      // Название страны
  final String? type;         // Название типа
  final String? appearance;   // Название внешнего вида
  final String? temperature;  // Температура заваривания
  final String? brewingGuide; // Руководство по завариванию (Rich Text)
  final String? weight;       // Вес
  final String? description;  // Описание (Rich Text)
  final List<String> flavors; // Названия вкусов
  final List<String> images;  // URL изображений
}
```

### 2. Связи данных
- **Tea → Country** (many-to-one)
- **Tea → Type** (many-to-one)
- **Tea → Appearance** (many-to-one)
- **Tea → Flavor** (many-to-many через промежуточную таблицу)

## Пользовательский интерфейс

### 1. Главный экран (HomeScreen)
- Список чаёв с карточками
- Индикаторы пагинации и загрузки
- Боковое меню с фильтрами
- Индикаторы статуса подключения
- Кнопка добавления нового чая

### 2. Фильтры
- **Мультиселект:** Выбор нескольких значений, поиск внутри списков
- **Фасетные:** Отображение количества результатов, сортировка по популярности

### 3. Добавление чая
- Многосекционная форма
- Выбор изображений
- Rich Text редакторы
- Валидация данных

### 4. Детали чая
- Полноразмерные изображения
- Форматированный текст
- Основная информация и характеристики

## Особенности реализации

### 1. Работа с Rich Text
- Использование flutter_quill
- Сохранение в формате Delta
- Отображение через flutter_widget_from_html

### 2. Управление изображениями
- Кеширование через cached_network_image
- Поддержка множественных изображений
- Локальное кеширование

### 3. Пагинация и производительность
- Бесконечный скролл
- Оптимизированные SQL запросы
- Ленивая загрузка данных

### 4. Оффлайн первостепенность
- Приоритет локальных данных при проблемах с API
- Автоматическая синхронизация
- Пользовательские уведомления

## Технические требования

### 1. Минимальные требования
- Flutter SDK: 3.10.8+
- Dart SDK: 3.10.8+
- Android: API level 21+
- iOS: 9.0+

### 2. Зависимости
- flutter_riverpod: ^3.2.1 (управление состоянием)
- sqflite: ^2.3.2 (локальная база данных)
- http: ^1.1.0 (HTTP клиент)
- flutter_quill: ^11.5.0 (Rich Text редактор)
- image_picker: ^1.2.1 (выбор изображений)
- connectivity_plus: ^6.0.3 (статус подключения)

## Масштабируемость

### 1. Архитектурные решения
- Модульная структура
- Четкое разделение ответственности
- Легко расширяемые компоненты

### 2. Возможности расширения
- Добавление новых типов фильтров
- Расширение модели данных
- Поддержка новых языков
- Интеграция с другими API

## Настройка названия приложения

- Название приложения устанавливается через переменную `APP_NAME` в файле `.env`
- Для Android: значение автоматически подхватывается из .env и используется в build.gradle.kts
- Для iOS: используется скрипт `ios/update_app_name.sh`, который обновляет Info.plist во время сборки
- Скрипт автоматически интегрирован в процесс сборки через Codemagic (codemagic.yaml)

## Локализация

- Поддержка русского и английского языков
- Использование Flutter l10n
- Локализованные строки интерфейса

## Рекомендации по разработке

### 1. Стиль кода
- Следование Flutter Style Guide
- Использование Riverpod best practices
- Чистый код с документированными методами

### 2. Тестирование
- Unit тесты для бизнес-логики
- Widget тесты для UI компонентов
- Интеграционные тесты для сценариев использования

### 3. Производительность
- Оптимизация SQL запросов
- Эффективное управление состоянием
- Кеширование и оптимизация изображений

## Будущие возможности

### 1. Потенциальные улучшения
- Поддержка синхронизации между устройствами
- Рейтинги и отзывы пользователей
- Рекомендательная система
- Поддержка дополнительных форматов изображений

### 2. Возможные интеграции
- Supabase для облачного хранения
- Аналитика использования
- Push уведомления
- Социальные функции

## Заключение

"Tea App" представляет собой современное мобильное приложение с продуманной архитектурой, обеспечивающей высокую производительность, масштабируемость и удобство использования. Архитектура приложения позволяет легко расширять функциональность и поддерживать код в долгосрочной перспективе.